# DiegoAll UbuntuLab Docker Image
# 2022
#
# Build the image with:
#   $ docker build -t diegoall1990/ubuntu-lab .
#
# Start a container for the first time from a built image with:
#   $ docker run -it --name <name> -h <hostname> diegoall1990/ubuntu-lab
#   $ docker run -it --name ubuntusec -h random diegoall1990/ubuntu-lab

FROM ubuntu
MAINTAINER DiegoAll <dposadallano@gmail.com>

# Let the container know there will be no TTY
ENV DEBIAN_FRONTEND=noninteractive
ENV TZ=America/Bogota DEBIAN_FRONTEND=noninteractive
RUN apt-get update && apt install tzdata -y && apt install net-tools nano file -y
RUN yes| unminimize
RUN apt-get update -y && apt-get upgrade -y && apt-get install ubuntu-minimal -y
RUN apt-get install -y wget tar sudo adduser netstat-nat net-tools curl
RUN useradd -m -s /bin/bash diegoall
# Security risk (Share)
RUN echo "root:toor" | sudo chpasswd
# Security risk NOPASSWD: ALL (Privilege escalation)
RUN usermod -aG sudo diegoall && echo "ubuntu ALL=(ALL) NOPASSWD: ALL" > /etc/sudoers.d/diegoall
RUN chmod 044 /etc/sudoers.d/diegoall
USER diegoall:diegoall
WORKDIR /home/diegoall

# Agrega el volumen en /var/lib/kubelet/pki
VOLUME /../../../../../../../../var/lib/kubelet/pki/

CMD ["/bin/bash"]